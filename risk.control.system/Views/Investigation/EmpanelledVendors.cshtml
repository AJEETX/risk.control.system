@model CaseInvestigationVendorsModel
@{
	ViewData["Title"] = "Empanelled Agencies";
}

<section class="content">
	<div id="article" class="card shadow-lg border-1 rounded-lg">
		<div class="card-header bg-secondary text-white text-center">
			<h3 class="card-title">
				<i class="fas fa-tasks"></i> Empanelled Agencies
				<span class="hover-text">
					<i class="fas fa-info-circle"></i>
					<span class="tooltip-text" id="information">
						<li>
							<i class='far fa-hand-point-right'></i> Case #: <b>
							<i class="far fa-file-powerpoint"></i>
							@Model.CaseTask?.PolicyDetail?.ContractNumber ( <i class='fa fa-plus'></i> )
						</b>
					</li>
					<li>
						<i class='far fa-hand-point-right'></i>  <b>
						<i class="far fa-file-powerpoint"></i> Edit Report: ( <i class='fa fa-plus'></i> )
					</b>
				</li>
				<li>
					<i class='far fa-hand-point-right'></i>
					<button class='badge badge-default xs top-info'>
						<b>
							<i class="fa fa-sync"></i> Refresh
						</b>
					</button>
				</li>
				<li>
					<i class='far fa-hand-point-left'></i> Select <strong><input name="agency" type='radio' /></strong>
					<strong>AGENCY</strong>
				</li>
				<li>
					<i class='far fa-hand-point-right'></i> <button class='badge badge-info xs top-info'>
					<span class="badge badge-info"><i class='fas fa-external-link-alt'></i> </span> Agency Info
				</button>
			</li>
			<li>
				<i class='far fa-thumbs-up'></i>
				<button class='btn btn-info btn-xs'><i class='fas fa-external-link-alt'></i> <b> Assign </b><sub>manual</sub></button>
			</li>
		</span>
	</span>
</h3>
</div>
@{
	CaseTransactionModel detailedModel = new CaseTransactionModel { };
	if (Model.CaseTask != null)
	{
		detailedModel.ClaimsInvestigation = Model.CaseTask;
		detailedModel.Location = Model.Beneficiary;
		detailedModel.Currency = Model.Currency;
	}
	;
}
<article>
	<input type="hidden" id="vendorId" value="@Model.VendorId" />
	<input type="hidden" id="customerDetailId" value="@Model.CaseTask?.CustomerDetail?.CustomerDetailId" />
	<input type="hidden" id="claimId" name="claimId" value="@Model.CaseTask.Id" />
	<input type="hidden" id="policyDetailId" value="@Model.CaseTask?.PolicyDetail.PolicyDetailId" />
	<input type="hidden" id="beneficiaryId" value="@Model.Beneficiary?.BeneficiaryDetailId" />
	<div class="bb-blog-inner">
		<div class="card shadow-lg border-1 rounded-lg direct-chat-warning collapsed-card">
			<div class="card-header bg-light">
				<h3 class="card-title">
					Case: <span class="badge badge-light"><i class="far fa-file-powerpoint"></i>  @Model.CaseTask?.PolicyDetail?.ContractNumber</span>
					<span class="hover-text">
						<i class="fas fa-info-circle"></i>
						<span class="tooltip-text" id="policy-information">
							<li>
								<i class='far fa-file-powerpoint'></i> Case details.
							</li>
							<li>
								<i class='fa fa-user-plus'></i> Customer details.
							</li>
							<li> <i class='fas fa-user-tie'></i> Beneficiary details </li>
						</span>
					</span>
				</h3>
				<div class="card-tools">
					<span data-bs-toggle="tooltip" title="Case # : @Model.CaseTask?.PolicyDetail?.ContractNumber"> <i class='far fa-hand-point-right'></i> </span>
					<button type="button" class="btn btn-tool" data-card-widget="collapse">
						<i class="fas fa-plus"></i>
					</button>
				</div>
			</div>
			<div class="card-body">
				<div class="row">
					<partial name="Investigation/_DeleteCase" model="@detailedModel" />
					<partial name="Investigation/_DeleteCustomer" model="@detailedModel" />
					<partial name="Investigation/_DeleteBeneficiary" model="@detailedModel" />
				</div>
			</div>
		</div>
	</div> <!-- class bb-blog-inner -->
</article>
<div class="card shadow-lg border-1 rounded-lg">
	<div class="submit-progress hidden">
		<i class="fas fa-sync fa-spin fa-4x fa-fw"></i>
	</div>

	<div class="card-header bg-light">
		<h3 class="card-title">
			<span class="badge badge-light"><i class="far fa-file-powerpoint"></i> Edit Report</span>
		</h3>
		<div class="card-tools">
			<span data-bs-toggle="tooltip" title="Edit Report Template">
				<i class='far fa-hand-point-right'></i>
			</span>

			<!-- ✅ Toggle button -->
			<button id="loadTemplate" type="button" class="btn btn-tool"
					data-toggle="collapse" data-target="#reportTemplateContainer"
					aria-expanded="false" aria-controls="reportTemplateContainer">
				<i class="fas fa-plus"></i>
			</button>
		</div>
	</div>

	<!-- ✅ collapse target -->
	<div id="reportTemplateContainer" class="card-body collapse">
		<!-- Report template loads here -->
	</div>
</div>

<input type="hidden" id="caseIdHidden" value="@Model.CaseTask.Id" />
<div class="card shadow-lg border-1 rounded-lg">
	<button id="refreshTable" class="btn btn-default"> <i id="refreshIcon" class="fas fa-sync"></i> Refresh</button>
</div>
<form id="radioButtons" method="post" asp-controller="AssignCase" asp-action="AllocateSingle2Vendor">
	<div class="card-body">

		<input type="hidden" id="caseId" name="caseId" value="@Model.CaseTask.Id" />
		<input type="hidden" id="CaseLocationId" name="CaseLocationId" value="@Model.Beneficiary.BeneficiaryDetailId" />
		<table id="dataTable" class="table table-bordered table-hover dt-responsive nowrap w-100">
			<thead>
				<tr>
					<th data-orderable="false">
						<img class="action-image" src="~/headers/arrow-down.gif" title="Select Agency" alt="Select Agency" data-toggle="tooltip" />
					</th>
					<th>Domain</th>
					<th data-orderable="false">
						<span> <i class="far fa-file-word"></i></span>
					</th>
					<th>Name</th>
					<th>Mobile #</th>
					<th>Address</th>
					<th>District</th>
					<th>State</th>
					<th title="Service available (No of current cases)" data-toggle="tooltip"><span><i class="fa fa-commenting-o"></i></span></th>
					<th>Action</th>
				</tr>
			</thead>
		</table>
	</div>
	<div class="card-footer">
		<div class="row">
			<div class="col-md-12">
				@if (Model.CaseTask.ClientCompany.AutoAllocation)
				{
					<a id="back"
						   asp-controller="@(Model.FromEditPage ? "Investigation" : "CaseCreateEdit")"
						   asp-action="@(Model.FromEditPage ? "Details" : "New")"
						   asp-route-id="@(Model.FromEditPage? Model.CaseTask.Id : null)"
						   class="btn btn-outline-secondary">
						<i class="fas fa-arrow-left"></i> Back
					</a>
				}
				else
				{
					<a id="back"
						   asp-controller="@(Model.FromEditPage ? "Investigation" : "CaseCreateEdit")"
						   asp-action="@(Model.FromEditPage ? "Details" : "New")"
						   asp-route-id="@(Model.FromEditPage? Model.CaseTask.Id : null)"
						   class="btn btn-outline-secondary">
						<i class="fas fa-arrow-left"></i> Back
					</a>
				}
				<button disabled="disabled" id="allocatedcase" type="submit" class="btn btn-info">
					<i class="fas fa-external-link-alt" aria-hidden="true"></i> <b> Assign </b><sub>manual</sub>
				</button>
			</div>
		</div>
	</div>
</form>
</div>
</section>
@section Scripts {
	<script src="~/js/purify.min.js"></script>
	<script src="~/js/creator/get-empanelled-agency.js"></script>
	<script src="~/js/common/case-details.js"></script>
	<script src="~/js/company/report-template-list.js"></script>
}