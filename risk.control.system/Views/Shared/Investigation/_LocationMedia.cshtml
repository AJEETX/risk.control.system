@using risk.control.system.Helpers;
@model LocationReport
@{
	var location = Model;
}

@if (location.MediaReports?.Any(d => d.Selected) == true)
{
	<div class="table-responsive mb-4">
		<table class="table table-bordered table-hover dt-responsive nowrap w-100">
			<thead class="thead-light">
			<tr>
				<th>Media File</th>
				<th>
					<i class="fas fa-copy text-muted ms-2" title="Scanned Document Image"></i>
				</th>
				<th title="Captured Address Map"><img class="action-image" src="~/headers/pincode.gif" /></th>
				<th>Captured Address</th>
					<th class="col-weather" title="Weather info"><img class="action-image" src="~/headers/information.gif" /></th>
				</tr>
		</thead>
		<tbody>
			@foreach (var doc in location.MediaReports.Where(d => d.Selected))
			{
				var accept = "audio/mpeg,audio/wav";
				if(doc.MediaType == MediaType.VIDEO)
				{
					accept = "video/mp4,video/webm";
				}
				<tr>
					<td>
							<small>
						@doc.ReportName
								</small>
						@if (doc.IsRequired)
						{
							<span class="required-asterisk" title="Mandatory Location">*</span>
						}
					</td>
					
					<td>
						@if (doc.ValidationExecuted)
						{
								<div id="doc-img-@doc.Id">
									@if (doc.MediaType == MediaType.VIDEO)
									{
										<video class="media-view" controls>
											<source src="@doc.FilePath" type="video/@doc.MediaExtension">
											Your browser does not support the video tag.
										</video>
									}
									else if (doc.MediaType == MediaType.AUDIO)
									{
										<audio controls>
											<source src="@doc.FilePath" type="audio/@doc.MediaExtension" />
										</audio>
									}
								</div>
						}
						else
						{
							if (doc.MediaType == MediaType.VIDEO)
									{
										<img src="~/img/no-video.png" class="thumbnail profile-image doc-profile-image" />
									}
									else{
										<img src="~/img/no-audio.png" class="thumbnail profile-image doc-profile-image" />
									}
						}

					</td>
					<td>
						@if (doc.ValidationExecuted && doc.LocationMapUrl != null)
						{
							<img id="face-img-@doc.Id"
								 src="@string.Format(@doc.LocationMapUrl, "300","300")"
								 class="thumbnail-image thumbnail profile-image doc-profile-image map-image"
								 data-faceid="@doc.Id"
								 data-locationid="@location.Id"
								 data-source="media"
								 title="Click to view map" />
								<div>
									<div>@doc.LongLat</div>
									<small>@doc.LocationAddress</small>
									<div class="badge badge-light">
										Indicative Distance from  @location.Address Address @doc.Distance
									</div>
								</div>
						}
						else
						{
							<img src="~/img/no-map.jpeg" class="thumbnail profile-image doc-profile-image" />
						}
					</td>
						<td>
							<small>
								@doc.LocationAddress
							</small>
							<span class="badge badge-light">
								Indicative Distance from @location.Address Address @doc.Distance
							</span>
						</td>
						<td>
							<small>
								@doc.LocationInfo
							</small>
						</td>
				</tr>
			}
		</tbody>
	</table>
	</div>
}
